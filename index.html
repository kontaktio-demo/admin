<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <title>Kontaktio Admin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="stylesheet" href="admin.css" />
    <link rel="icon" href="favicon.ico" />
  </head>

  <body>
    <!-- ========================= -->
    <!-- LOGIN VIEW -->
    <!-- ========================= -->
    <div id="login-view" class="view active">
      <div class="card">
        <h1>Kontaktio Admin</h1>
        <p class="subtitle">Panel zarządzania asystentami</p>

        <label class="field">
          <span>Hasło administratora</span>
          <input
            type="password"
            id="admin-password"
            autocomplete="current-password"
            placeholder="Wpisz hasło..."
          />
        </label>

        <button id="login-btn" class="primary">Zaloguj</button>
        <p id="login-error" class="error"></p>

        <p class="muted" style="margin-top: 14px">
          Jeśli po zalogowaniu nic się nie dzieje, to znaczy że widok panelu był ukryty
          przez klasy — ten plik to naprawia.
        </p>
      </div>
    </div>

    <!-- ========================= -->
    <!-- PANEL VIEW -->
    <!-- ========================= -->
    <div id="panel-view" class="view">
      <!-- TOPBAR -->
      <header class="topbar">
        <div>
          <h1>Kontaktio Admin</h1>
          <p class="subtitle">Zarządzanie klientami i konfiguracją AI</p>
        </div>

        <div class="topbar-right" style="display:flex; align-items:center; gap:12px;">
          <span class="muted">Zalogowano</span>
          <button id="logout-btn" class="ghost">Wyloguj</button>
        </div>
      </header>

      <!-- MAIN LAYOUT -->
      <main class="layout">
        <!-- SIDEBAR -->
        <aside class="sidebar">
          <div class="sidebar-header">
            <h2>Klienci</h2>
            <button id="add-client-btn" title="Dodaj klienta">+</button>
          </div>

          <ul id="clients-list"></ul>
        </aside>

        <!-- CONTENT -->
        <section class="content">
          <!-- TABS -->
          <div class="tabs">
            <!-- WAŻNE: data-tab musi pasować do .tab-content[data-tab="..."] -->
            <button type="button" class="tab-button active" data-tab="settings">
              Ustawienia
            </button>
            <button type="button" class="tab-button" data-tab="stats">
              Statystyki
            </button>
            <button type="button" class="tab-button" data-tab="logs">
              Logi
            </button>
            <button type="button" class="tab-button" data-tab="preview">
              Podgląd
            </button>
          </div>

          <!-- EMPTY STATE -->
          <div id="empty-state" class="empty">
            Wybierz klienta z listy po lewej, aby edytować jego konfigurację.
          </div>

          <!-- ========================= -->
          <!-- TAB: SETTINGS (FORM) -->
          <!-- ========================= -->
          <!-- WAŻNE: 
               - musi mieć id="client-form"
               - musi mieć class="client-form tab-content"
               - musi mieć data-tab="settings"
               - domyślnie NIE musi być active, bo admin.js robi .classList.add("active") po wyborze klienta
               - ALE tab system wymaga .tab-content.active aby było widoczne => admin.js robi active na tab-content po klikach.
               Żeby panel zawsze był czytelny, dajemy aktywny settings tab-content od startu. -->
          <form
            id="client-form"
            class="client-form tab-content active"
            data-tab="settings"
            style="display:none;"
          >
            <!-- Ten style=display:none jest celowy:
                 admin.js po wyborze klienta robi clientForm.classList.add("active"),
                 a CSS .tab-content.active ma display:block, ale Twój .client-form nie ma reguły "active".
                 Zrobimy to bez ruszania CSS: poniżej wstawiamy małą regułę inline. -->
            <div class="form-header">
              <h2 id="client-id-label"></h2>
              <button type="button" id="delete-client-btn" class="danger-outline">
                Usuń klienta
              </button>
            </div>

            <!-- COMPANY -->
            <h3>Dane firmy</h3>
            <div class="grid two">
              <div class="field">
                <span>Nazwa firmy</span>
                <input type="text" id="company-name" />
              </div>
              <div class="field">
                <span>Email</span>
                <input type="email" id="company-email" />
              </div>
              <div class="field">
                <span>Telefon</span>
                <input type="text" id="company-phone" />
              </div>
              <div class="field">
                <span>Adres</span>
                <input type="text" id="company-address" />
              </div>
              <div class="field">
                <span>Godziny otwarcia</span>
                <input type="text" id="company-hours" />
              </div>
            </div>

            <!-- STATUS -->
            <h3>Status</h3>
            <div class="grid two">
              <div class="field">
                <span>Status</span>
                <select id="client-status">
                  <option value="active">active</option>
                  <option value="unactive">unactive</option>
                </select>
              </div>
              <div class="field">
                <span>Komunikat statusu</span>
                <input type="text" id="client-status-message" />
              </div>
            </div>

            <!-- AI -->
            <h3>AI — Model i parametry</h3>
            <div class="grid two">
              <div class="field">
                <span>Model</span>
                <input type="text" id="model" />
              </div>
              <div class="field">
                <span>Temperature</span>
                <input type="number" step="0.05" min="0" max="1" id="temperature" />
              </div>
              <div class="field">
                <span>Max tokens</span>
                <input type="number" id="max-tokens" />
              </div>
              <div class="field">
                <span>Top‑p</span>
                <input type="number" step="0.05" min="0" max="1" id="top-p" />
              </div>
              <div class="field">
                <span>Presence penalty</span>
                <input type="number" step="0.1" id="presence-penalty" />
              </div>
              <div class="field">
                <span>Frequency penalty</span>
                <input type="number" step="0.1" id="frequency-penalty" />
              </div>
              <div class="field">
                <span>Context limit</span>
                <input type="number" id="context-limit" />
              </div>
            </div>

            <div class="field">
              <span>System prompt</span>
              <textarea id="system-prompt" rows="4"></textarea>
            </div>

            <div class="field">
              <span>Knowledge</span>
              <textarea id="knowledge" rows="6"></textarea>
            </div>

            <div class="field">
              <span>Rules</span>
              <textarea id="rules" rows="4"></textarea>
            </div>

            <!-- BEHAVIOR -->
            <h3>Zachowanie</h3>
            <div class="grid two">
              <div class="field">
                <span>Welcome message</span>
                <input type="text" id="welcome-message" />
              </div>
              <div class="field">
                <span>Welcome hint</span>
                <input type="text" id="welcome-hint" />
              </div>
              <div class="field">
                <span>Launcher icon</span>
                <input type="text" id="launcher-icon" />
              </div>
              <div class="field">
                <span>Auto‑open</span>
                <select id="auto-open-enabled">
                  <option value="false">false</option>
                  <option value="true">true</option>
                </select>
              </div>
              <div class="field">
                <span>Auto‑open delay (ms)</span>
                <input type="number" id="auto-open-delay" />
              </div>
            </div>

            <div class="field">
              <span>Quick replies (oddzielone przecinkami)</span>
              <input type="text" id="quick-replies" />
            </div>

            <!-- SAVE -->
            <div class="form-footer">
              <button type="submit" class="primary">Zapisz zmiany</button>
              <span id="save-status" class="muted"></span>
            </div>
          </form>

          <!-- ========================= -->
          <!-- TAB: STATS -->
          <!-- ========================= -->
          <div class="tab-content" data-tab="stats">
            <h2>Statystyki</h2>
            <div id="stats-content" class="stats-grid"></div>
          </div>

          <!-- ========================= -->
          <!-- TAB: LOGS -->
          <!-- ========================= -->
          <div class="tab-content" data-tab="logs">
            <h2>Logi rozmów</h2>
            <div id="logs-content" class="logs-list"></div>
          </div>

          <!-- ========================= -->
          <!-- TAB: PREVIEW -->
          <!-- ========================= -->
          <div class="tab-content" data-tab="preview">
            <h2>Podgląd widgetu</h2>
            <div class="preview-container">
              <iframe id="widget-preview"></iframe>
            </div>
          </div>
        </section>
      </main>

      <!-- MAŁA, KRYTYCZNA POPRAWKA POD NASZ admin.js:
           admin.js robi: clientForm.classList.add("active") po wyborze klienta,
           ale Twoje CSS nie ma reguły .client-form.active { display:block }.
           Nie ruszamy admin.css, więc dodajemy to tutaj, żeby "działało zawsze". -->
      <style>
        #client-form.active { display: block !important; }
        #client-form:not(.active) { display: none !important; }
      </style>
    </div>

    <script src="admin.js"></script>
  </body>
</html>
